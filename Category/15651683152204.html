<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>  
	  
  	对象 -        凌云阁
  	
	</title>

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="atom.xml" rel="alternate" title="       凌云阁" type="application/atom+xml">

	<link href="asset/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="asset/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<script src="asset/javascripts/jquery.min.js"></script>
	<script src="asset/highlightjs/highlight.pack.js"></script>
	<link href="asset/highlightjs/styles/solarized_dark.css" media="screen, projection" rel="stylesheet" type="text/css">
<script>hljs.initHighlightingOnLoad();</script>

	<!--[if lt IE 9]><script src="asset/javascripts/html5.js"></script><![endif]-->
	<!-- <link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'> -->
	<style type="text/css">
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 300;
  src: local('Nunito-Light'), url(asset/font/1TiHc9yag0wq3lDO9cw0voX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 400;
  src: local('Nunito-Regular'), url(asset/font/6TbRXKWJjpj6V2v_WyRbMX-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 700;
  src: local('Nunito-Bold'), url(asset/font/TttUCfJ272GBgSKaOaD7KoX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
	</style>
	
	<style type="text/css">
	.container .left-col{ opacity: 1;}
	#pagenavi a{ font-size: 1.3em;}
	#pagenavi .next:before{ top: 3px;}
	#pagenavi .prev:before{ top: 3px;}
	.container .mid-col .mid-col-container #content .archives .title{ font-size: 1.5em;}
	.container .mid-col .mid-col-container #content article{ padding: 15px 0px;}
	#header .subtitle {
		line-height: 1.2em;
		padding-top: 8px;
	}
	article pre{ background: none; border: none; padding: 0;}
	article .entry-content{text-align: left;}
	.share-comment{ padding: 25px 0px; clear: both;}
	hr{ margin: 20px 0px;border: 0; border-top:solid 1px #ddd;}

	</style>
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner">
				 
				 	<div class="profilepic">
						<img src="https://i.loli.net/2020/02/22/Si1K7sluept2ZgR.jpg" style="width:160px;">
					</div>
            	
					
					<h1><a href="index.html">       凌云阁</a></h1>
					<p class="subtitle">生命的意义是成为你自己！</p>
					<nav id="main-nav">
						<ul class="main">
						
						  <li id=""><a target="_self" href="index.html">Home</a></li>
						
						  <li id=""><a target="_self" href="archives.html">Archives</a></li>
						
						</ul>
					</nav>

					<nav id="sub-nav">
						<div class="social">

<a target="_blank" class="facebook" href="www.facebook.com" title="Facebook">Facebook</a>






<a target="_blank" class="weibo" href="www.weibo.com" title="weibo">Weibo</a>
<a target="_blank" class="twitter" target="_blank" href="www.twitter.com" title="Twitter">Twitter</a>
<a target="_blank" class="github" target="_blank" href="www.github.com/chawlau" title="GitHub">GitHub</a>


								

								<a class="rss" href="atom.xml" title="RSS">RSS</a>
							
						</div>
					</nav>
				</header>				
			</div>
		</div>	
		<div class="mid-col">
			<div class="mid-col-container"> <div id="content" class="inner">

	<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
		<h1 class="title" itemprop="name">对象</h1>
		<div class="entry-content" itemprop="articleBody">
			<h4><a id="%E7%B1%BB%E5%AF%B9%E8%B1%A1%E7%A9%BA%E9%97%B4" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>类对象空间</h4>
<ul>
<li>类的成员函数不占用类的空间，成员</li>
</ul>
<h4><a id="%E5%AF%B9%E8%B1%A1%E7%BB%93%E6%9E%84%E7%9A%84%E5%8F%91%E5%B1%95%E5%92%8C%E6%BC%94%E5%8C%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>对象结构的发展和演化</h4>
<ul>
<li>非静态的成员变量跟着类对象走，类对象都有自己的成员变量</li>
<li>静态成员变量不保存在类中</li>
<li>虚函数会让类多8个字节，类会产生指向虚函数的指针，有两个虚函数，类会产生两个指向虚函数的指针</li>
<li>类本身指向虚函数的指针vptr，要有地方存放，存放在一个表格，虚函数表</li>
<li>vptr由系统在适当的时机增加额外的代码来赋值</li>
<li>虚函数表是基于类的，跟对象没有关系</li>
<li>如果有多个数据成员，内存对齐</li>
</ul>
<h4><a id="%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>对象模型</h4>
<ul>
<li><img src="media/15651683152204/15651729969739.jpg" alt="" style="width:752px;" /></li>
</ul>
<h4><a id="this%E6%8C%87%E9%92%88" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>this指针</h4>
<ul>
<li>派生类对象，它是包含基类子对象、</li>
<li>派生类同时继承多个基类，第一个基类的地址和派生类地址相同</li>
</ul>
<h4><a id="%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E8%AF%AD%E4%B9%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>构造函数语义</h4>
<ul>
<li>含成的默认构造函数，只有在必要的时候，编译器オ会为我们合成出来，而不是必然或者必须为我们合成出来</li>
<li>生成预处理文件g++ -E obj3.cpp -o obj3.i</li>
</ul>
<h4><a id="%E7%BC%96%E8%AF%91%E5%99%A8%E4%BD%95%E6%97%B6%E4%BC%9A%E6%8A%8A%E9%BB%98%E8%AE%A4%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A0%E5%87%BA%E6%9D%A5" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>编译器何时会把默认的构造函数构造出来</h4>
<ul>
<li>任何构造国数，但包合含一个对象类型的成员而该对象所属于的类MATX 有ー个缺省的构造函数。编译器会为MBTX合成一个默认的构造函数，并且安插代码，调用MATX的缺省构造函数</li>
<li>父类带缺省的构造函数，子类没有任何构造函数，为了调用父类的构造函数</li>
<li>一个类含有虚函数，都是没有构造函数 编译器会给我们生成一全基于该类的虚函数表 vtable，把类的虚函数表地址赋值给类对象的虚函数指针</li>
<li>一个类带有虚基类</li>
<li><img src="media/15651683152204/15652598709736.jpg" alt="" style="width:452px;" /></li>
<li>虚基类结构，编译器为子类和父类都产生了默认构造函数</li>
</ul>
<pre><code class="language-plain_text"> objdump  -j .text._ZN4MBTXC2Ev -x -C obj3.o 查看构造函数
 objdump -t -C obj3.o 查看函数符号表
 objdump  -x -C obj3.o 
</code></pre>
<h4><a id="%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>拷贝构造函数</h4>
<ul>
<li>合成的拷贝构造函数也是在必要的时候才会被合成出来</li>
<li>成员变量初始化手法，int简单类型直接按值拷贝过去，不需要拷贝构造</li>
</ul>
<h4><a id="%E7%BC%96%E8%AF%91%E5%99%A8%E5%90%88%E6%88%90%E7%9A%84%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>编译器合成的拷贝构造函数</h4>
<ul>
<li>如果一个类没有拷贝构造函数，但是含有一个类类型CTB的成员变量，该类型CTB含有拷贝构造函数，当代码中有涉及到类A的拷贝构造函数，编译器会合成构造函数</li>
<li>如果一个类没有拷贝构造函数，但是有一个父类有拷贝构造函数，当代码中有涉及到拷贝构造时，编译器会合成拷贝构造函数</li>
<li>如果类没有拷贝构造函数，但是该类声明或者继承了虚函数，编译器会自动为其构建拷贝构造函数，为了设定类对象虚函数表指针</li>
<li>如果一个类中有虚基类时，涉及到该类的拷贝构造函数，编译器会为其生成拷贝构造</li>
<li>其他编译器合成拷贝构造函数的情况</li>
</ul>
<h4><a id="%E7%A8%8B%E5%BA%8F%E8%BD%AC%E5%8C%96%E8%AF%AD%E4%B9%89" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>程序转化语义</h4>
<ul>
<li>编译器对代码进行拆分，拆分成编译器更容易理解和转化的语言</li>
<li>X x100,从编译器视角来看，并没有调用构造函数</li>
<li>x100.X::X(x0)</li>
</ul>
<h5><a id="%E8%BF%94%E5%9B%9E%E5%80%BC%E5%88%9D%E5%A7%8B%E5%8C%96" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>返回值初始化</h5>
<ul>
<li>linux针对返回临时对象的优化NRV和NRVO的优化</li>
<li>关闭优化g++ -o test  -fno-elide-constructors obj10.cpp</li>
<li>优化可能犯错误</li>
</ul>
<h4><a id="%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%98%AF%E5%90%A6%E5%BF%85%E9%A1%BB" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>拷贝构造函数是否必须</h4>
<ul>
<li>如果只有一些简单的成员变量类型int,double,根本不需要拷贝构造函数，编译器本身就支持bitewise copy</li>
<li>复杂类型的成员变量需要拷贝构造函数</li>
<li>如果增加了自己的拷贝构造函数，导致编译器本身的bitewise的拷贝构造失败，需要自己在拷贝构造函数进行成员变量初始化</li>
</ul>
<h4><a id="%E6%88%90%E5%91%98%E5%88%97%E8%A1%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>成员列表</h4>
<h5><a id="%E5%BF%85%E9%A1%BB%E4%BD%BF%E7%94%A8%E6%88%90%E5%91%98%E5%88%97%E8%A1%A8" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>必须使用成员列表</h5>
<ul>
<li>成员是个引用</li>
<li>成员是个const</li>
<li>类继承基类，基类中有构造函数，基类构造函数有参数</li>
<li>成员变量是类类型，构造函数也是带参数的</li>
</ul>
<h5><a id="%E4%BD%BF%E7%94%A8%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%97%E8%A1%A8%E7%9A%84%E4%BC%98%E5%8A%BF" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>使用初始化列表的优势</h5>
<ul>
<li>提高程序运行效率</li>
<li>初始化列表的代码还是会到函数体中执行，初始化的列表代码会被编译器移动进函数体</li>
<li>对于类类型的成员变量的初始化放到列表效率有明显的提升</li>
<li>简单类型放在初始化列表中</li>
<li>构造函数的代码是在构造函数代码之前执行</li>
<li>列表中的初始化顺序是类中定义的顺序，编译器按定义的值来赋值</li>
<li></li>
</ul>

		</div>
	</article>
	<div class="share-comment">
	 

	  

	  

	</div>
</div>        </div>
			<footer id="footer" class="inner">Copyright &copy; 2014
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a> &nbsp;&nbsp; 
Theme by <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
      </footer>
		</div>
	</div>

  
    



</body>
</html>