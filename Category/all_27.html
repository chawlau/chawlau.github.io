<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  eredin-blog
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="eredin-blog" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
  <script src="asset/highlightjs/highlight.pack.js"></script>
  <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site: ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }
</script>
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="self" href="index.html">Home</a></li>
        
        <li id=""><a target="_self" href="archives.html">Archives</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
<form target="_blank" onsubmit="return before_search();" action="https://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; eredin-blog</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="self" href="index.html">Home</a></li>
        
        <li><a target="_self" href="archives.html">Archives</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="Prometheus.html">Prometheus</a></li>
        
            <li><a href="RocketMQ.html">RocketMQ</a></li>
        
            <li><a href="%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE.html">网络协议</a></li>
        
            <li><a href="Golang.html">Golang</a></li>
        
            <li><a href="Django.html">Django</a></li>
        
            <li><a href="C++%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%AE%9E%E6%88%98.html">C++设计模式实战</a></li>
        
            <li><a href="%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90Kubernetes.html">深入剖析Kubernetes</a></li>
        
            <li><a href="%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95.html">数据结构和算法</a></li>
        
            <li><a href="%E5%BE%AE%E6%9C%8D%E5%8A%A1.html">微服务</a></li>
        
            <li><a href="%E6%9E%B6%E6%9E%84.html">架构</a></li>
        
            <li><a href="%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86.html">操作系统原理</a></li>
        
            <li><a href="Mysql%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98.html">Mysql优化实战</a></li>
        
            <li><a href="Kafka.html">Kafka</a></li>
        
            <li><a href="linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A0%94%E5%8F%91.html">linux服务器研发</a></li>
        
            <li><a href="%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.html">计算机组成原理</a></li>
        
            <li><a href="%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB.html">程序员的自我修养</a></li>
        
            <li><a href="C%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6.html">C语言进阶</a></li>
        
            <li><a href="http_study.html">http_study</a></li>
        
            <li><a href="%E7%8E%A9%E8%BD%AC%E7%AE%97%E6%B3%95.html">玩转算法</a></li>
        
            <li><a href="C++%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B.html">C++对象模型</a></li>
        
            <li><a href="SQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A.html">SQL必知必会</a></li>
        
            <li><a href="Zookeeper.html">Zookeeper</a></li>
        
            <li><a href="Redis%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A.html">Redis从入门到精通</a></li>
        
            <li><a href="%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95%E8%BF%9B%E9%98%B6.html">数据结构和算法进阶</a></li>
        
            <li><a href="Mysql%E6%80%A7%E8%83%BD%E7%AE%A1%E7%90%86%E5%92%8C%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html">Mysql性能管理和架构设计</a></li>
        
            <li><a href="%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98.html">网络编程实战</a></li>
        
            <li><a href="Redis%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BC%93%E5%AD%98.html">Redis高并发缓存</a></li>
        
            <li><a href="C++%E5%9F%BA%E7%A1%80%E4%B8%8E%E6%8F%90%E9%AB%98.html">C++基础与提高</a></li>
        
            <li><a href="%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BE%8E.html">设计模式之美</a></li>
        
            <li><a href="Python.html">Python</a></li>
        
            <li><a href="%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html">设计模式</a></li>
        
            <li><a href="Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98.html">Linux性能优化实战</a></li>
        
            <li><a href="%E5%80%99%E6%8D%B7STL.html">候捷STL</a></li>
        
            <li><a href="%E6%80%A7%E8%83%BD%E5%B7%A5%E7%A8%8B%E9%AB%98%E6%89%8B%E8%AF%BE.html">性能工程高手课</a></li>
        
            <li><a href="%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html">性能测试</a></li>
        
            <li><a href="ElasticSearch.html">ElasticSearch</a></li>
        
            <li><a href="RabbitMQ.html">RabbitMQ</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
	$(function(){
		$('#menu_item_index').addClass('is_active');
	});
</script>
<div class="row">
	<div class="large-8 medium-8 columns">
		<div class="markdown-body home-categories">
		
			<div class="article">
                <a class="clearlink" href="15661792809222.html">
                
                  <h1>B+树</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>常见数据结构优缺点</h4>

<ul>
<li>散列表的查询性能很好，时间复杂度是 O(1)。但是，散列表不能支持按照区间快速查找数据。所以，散列表不能满足我们的需求</li>
<li>平衡二叉查找树。尽管平衡二叉查找树查询的性能也很高，时间复杂度是 O(logn)。而且，对树进行中序遍历，我们还可以得到一个从小到大有序的数据序列，但这仍然不足以支持按照区间快速查找数据</li>
<li>跳表是在链表之上加上多层索引构成的。它支持快速地插入、查找、删除数据，对应的时间复杂度是 O(logn)。并且，跳表也支持按照区间快速地查找数据。我们只需要定位到区间起点值对应在链表中的结点，然后从这个结点开始，顺序遍历链表，直到区间终点对应的结点为止，这期间遍历得到的数据就是满足区间值的数据</li>
</ul>

<h4>改造二叉树</h4>

<ul>
<li>树中的节点并不存储数据本身，而是只是作为索引。除此之外，我们把每个叶子节点串在一条链表上，链表中的数据是从小到大有序的</li>
<li>磁盘 IO 操作非常耗时，所以我们优化的重点就是尽量减少磁盘 IO 操作，也就是，尽量降低树的高度</li>
<li>内存和磁盘的数据读取都是按页来的</li>
<li>选择m的时候，尽量让每个节点等于一个页的大小，如果超过m的话，就要将页面进行分裂</li>
<li>每个节点的子节点都比较少，势必会影响索引的效率， B+ 树中，这个阈值等于 m/2。如果某个节点的子节点个数小于 m/2，我们就将它跟相邻的兄弟节点合并</li>
</ul>

<h4>B树木</h4>

<ul>
<li>B 树只是一个每个节点的子节点个数不能小于 m/2 的 m 叉树</li>
<li>B+ 树中，将叶子节点串起来的链表，是双向链表方便asc和desc</li>
<li>B+ 树查询效率更稳定。因为 B+ 树每次只有访问到叶子节点才能找到对应的数据，而在 B 树中，非叶子节点也会存储数据，这样就会造成查询效率不稳定的情况，有时候访问到了非叶子节点就可以找到关键字，而有时需要访问到叶子节点才能找到关键字</li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/19 09:48 上午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95.html'>数据结构和算法</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15660869706932.html">
                
                  <h1>聚集函数</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>分类</h4>

<ul>
<li>count COUNT(role_assist)会忽略值为 NULL 的数据行，而 COUNT(*) 只是统计数据行数，不管某个字段是否为 NULL</li>
<li>max</li>
<li>min</li>
<li>sum</li>
<li>avg</li>
</ul>

<h4>注意</h4>

<ul>
<li>使用 MAX 和 MIN 函数统计数据行的时候，不需要再额外使用 DISTINCT</li>
</ul>

<h4>过滤分组</h4>

<ul>
<li>having</li>
<li>HAVING 的作用和 WHERE 一样，都是起到过滤的作用，只不过 WHERE 是用于数据行，而 HAVING 则作用于分组。</li>
</ul>

<h4>例题</h4>

<ul>
<li>筛选最大生命值大于 6000 的英雄，按照主要定位进行分组，选择分组英雄数量大于 5 的分组，按照分组英雄数从高到低进行排序，并显示每个分组的英雄数量、主要定位和平均最大生命值。</li>
<li>筛选最大生命值与最大法力值之和大于 7000 的英雄，按照攻击范围来进行分组，显示分组的英雄数量，以及分组英雄的最大生命值与法力值之和的平均值、最大值和最小值，并按照分组英雄数从高到低进行排序，其中聚集函数的结果包括小数点后两位。</li>
</ul>

<pre class="line-numbers"><code class="language-text">1.SELECT COUNT(*) AS num,role_main,AVG(hp_max) FROM heros WHERE hp_max &gt; 6000 GROUP 
BY role_main HAVING num&gt;5 ORDER BY num DESC; 
2.SELECT COUNT(*) AS num,ROUND(MAX(hp_max+mp_max),2),ROUND(AVG(hp_max+mp_max),2),
ROUND(MIN(hp_max+mp_max),2) FROM heros WHERE hp_max+mp_max &gt; 7000 GROUP BY attack_range
ORDER BY num DESC;
</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/18 08:09 上午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='SQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A.html'>SQL必知必会</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15660857101922.html">
                
                  <h1>sql函数</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>分类</h4>

<ul>
<li>算术函数</li>
<li>字符串函数</li>
<li>日期函数</li>
<li>转换函数</li>
</ul>

<h4>算术函数</h4>

<ul>
<li>ABS</li>
<li>MOD</li>
<li>ROUND</li>
</ul>

<h4>日期函数</h4>

<ul>
<li><p><img src="media/15660857101922/3dec8d799b1363d38df34ed3fdd29045.png" alt="3dec8d799b1363d38df34ed3fdd29045"/></p></li>
<li><p>datetime类型和string类型比较不安全</p></li>
<li><p>无法确认 birthdate 的数据类型是字符串，还是 datetime 类型，如果你想对日期部分进行比较，那么使用DATE(birthdate)来进行比较是更安全的</p></li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/18 07:48 上午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='SQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A.html'>SQL必知必会</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15660842826043.html">
                
                  <h1>表设计原则</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>三少一多</h4>

<ul>
<li>数据表个数越少越好</li>
<li>数据表的字段个数越少越好</li>
<li>数据表中联合主键的字段个数越少越好</li>
<li>使用主键越多越好</li>
</ul>

<h4>执行顺序</h4>

<ul>
<li>SELECT ... FROM ... WHERE ... GROUP BY (聚集函数)... HAVING ... ORDER BY ...</li>
<li>首先先通过 CROSS JOIN 求笛卡尔积，相当于得到虚拟表 vt（virtual table）1-1；</li>
<li>通过 ON 进行筛选，在虚拟表 vt1-1 的基础上进行筛选，得到虚拟表 vt1-2；</li>
<li>添加外部行。如果我们使用的是左连接、右链接或者全连接，就会涉及到外部行，也就是在虚拟表 vt1-2 的基础上增加外部行，得到虚拟表 vt1-3</li>
<li>FROM &gt; WHERE &gt; GROUP BY &gt; HAVING &gt; SELECT 的字段 &gt; DISTINCT &gt; ORDER BY &gt; LIMIT</li>
<li>每个步骤都会产生虚拟表</li>
</ul>

<h4>执行效率</h4>

<ul>
<li>COUNT(*) = COUNT(1) &gt; COUNT(字段)</li>
<li>COUNT(*)和COUNT(1)本质上没有区别，执行的复杂度都是O(N)，也就是采用全表扫描，进行循环+计数的方式进行统计。</li>
<li>count(*)和count(1)一般要建立二级索引</li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/18 07:24 上午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='SQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A.html'>SQL必知必会</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15660840293357.html">
                
                  <h1>SQL 执行方式</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>mysql架构</h4>

<ul>
<li><img src="media/15660840293357/c4b24ef2377e0d233af69925b0d7139e.png" alt="c4b24ef2377e0d233af69925b0d7139e"/></li>
</ul>

<h4>sql层架构</h4>

<ul>
<li><img src="media/15660840293357/30819813cc9d53714c08527e282ede79-2.jpg" alt="30819813cc9d53714c08527e282ede79-2"/></li>
<li>查询缓存：Server 如果在查询缓存中发现了这条 SQL 语句，就会直接将结果返回给客户端；如果没有，就进入到解析器阶段。需要说明的是，因为查询缓存往往效率不高，所以在 MySQL8.0 之后就抛弃了这个功能。</li>
<li>解析器：在解析器中对 SQL 语句进行语法分析、语义分析。</li>
<li>优化器：在优化器中会确定 SQL 语句的执行路径，比如是根据全表检索，还是根据索引来检索等。</li>
<li>执行器：在执行之前需要判断该用户是否具备权限，如果具备权限就执行 SQL 查询并返回结果。在 MySQL8.0 以下的版本，如果设置了查询缓存，这时会将查询结果进行缓存</li>
</ul>

<h4>sql执行分析</h4>

<ul>
<li>set profiling = 1;</li>
<li>show profile</li>
<li></li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/18 07:20 上午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='SQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A.html'>SQL必知必会</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15659624980235.html">
                
                  <h1>zookeeper简介</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>功能</h4>

<ul>
<li>中间件 提供协调服务</li>
<li>分布式系统，发挥其优势，可以为大数据服务</li>
<li>支持java和c语言</li>
</ul>

<h4>分布式系统特性</h4>

<ul>
<li>一致性</li>
<li>原子性</li>
<li>单一视图</li>
<li>可靠性 每次对zk的操作状态都保存在服务端</li>
<li>实时性 客户端可以读取zk服务端的最新数据</li>
</ul>

<h4>zk目录</h4>

<ul>
<li>docs 文档</li>
<li>cfg配置</li>
<li>tickTime 用于计算的时间单元</li>
<li>initLimit 节点同步到master节点的时间</li>
<li>synLimit 心跳时间</li>
</ul>

<h4>基本模型</h4>

<ul>
<li>树形结构来区分目录</li>
<li>每一个节点为znode</li>
<li>临时节点和永久节点</li>
<li>zk节点都有各自的版本号</li>
<li>节点数据发生变化，节点的版本号会累加(乐观锁)</li>
<li>删除修改过时节点，版本号不匹配会报错</li>
<li>zk节点存储的数据不适宜过大，几K</li>
<li>节点可以设置权限acl，控制用户的访问</li>
</ul>

<h4>zookeeper作用</h4>

<ul>
<li>master节点选举</li>
<li>统一配置文件管理，比如修改了redis统一配置</li>
<li>分布与订阅，发布者把数据存在znode上，订阅者会读取这个数据</li>
<li>分布式锁，分布式环境中不同进程之间争夺资源，类似多线程的锁</li>
<li>集群管理，保证数据的强一致性</li>
</ul>

<h4>常用命令行</h4>

<ul>
<li>ls ls2</li>
<li>ls2 查看状态信息</li>
</ul>

<pre class="line-numbers"><code class="language-text">cZxid = 0x0 创建的id
ctime = Thu Jan 01 08:00:00 CST 1970
mZxid = 0x0
mtime = Thu Jan 01 08:00:00 CST 1970
pZxid = 0x50000002f 子节点的id
cversion = 18 子节点
dataVersion = 0 当前节点的数据版本号
aclVersion = 0 
ephemeralOwner = 0x0
dataLength = 0
numChildren = 12
</code></pre>

<h4>session基本原理</h4>

<ul>
<li>客户端和服务器之间的连接存在会话</li>
<li>每个会话都可以设置一个超时时间</li>
<li>心跳结束，session则过期</li>
<li>session过期，临时节点znode全部会被抛弃</li>
<li>心跳机制 客户端向服务端的ping包</li>
</ul>

<h4>常用命令</h4>

<ul>
<li>create -e path data</li>
<li>临时节点 ephemeralOwner = 0x1000a643cae0002，临时节点会在时效性结束后被删除</li>
<li>持久节点 ephemeralOwner = 0x0</li>
<li>顺序节点 create -s /imooc/sec seq</li>
<li>set path data 乐观锁</li>
</ul>

<h4>watch机制</h4>

<ul>
<li>针对每个节点的操作，都会有一个监督者，watcher</li>
<li>当监控的某个对象znode发生了变化，则触发watcher事件</li>
<li>zk的watcher是一次性的，触发后立即销毁</li>
<li>父子节点增删改都能够出发其watcher</li>
<li>watcher事件也不同</li>
<li>子节点创建事件</li>
<li>子节点删除事件</li>
<li>子节点数据变化事件</li>
</ul>

<h4>父节点事件</h4>

<ul>
<li>get </li>
<li>NodeCreate</li>
<li>NodeDataChanged</li>
<li>NodeDeleted</li>
</ul>

<h4>子节点事件</h4>

<ul>
<li>ls 创建子节点 NodeChildrenChanged</li>
<li>ls 删除子节点 NodeChildrenChanged</li>
<li>ls 修改子节点不触发事件 必须set -s /imooc/xyz 9090</li>
</ul>

<h4>wathcher资源配置</h4>

<ul>
<li>统一资源配置</li>
</ul>

<h3>ACL权限控制</h3>

<ul>
<li>getAcl </li>
<li>setAcl</li>
<li>addauth 输入认证授权信息</li>
<li>Zk 的 ac 通过【scheme: id: permissions】来构成权限列表 scheme：代表采用的某种权限机制 d：代表允许访问的用户 permissions：权限组合字符串</li>
<li>world </li>
<li>auth 认证登录</li>
<li>digest需要对密码加密才能访问</li>
</ul>

<h4>permissions</h4>

<ul>
<li>crdwa</li>
<li>create</li>
<li>read</li>
<li>write</li>
<li>delete</li>
<li>admin 设置权限</li>
</ul>

<h4>digest</h4>

<ul>
<li>addauth digest imooc:imooc</li>
<li>setAcl /names/imooc  auth:imooc:imooc:adrwa</li>
<li>设置 setAcl -s /names/test digest:imooc:XwEDaL3J0JQGkRQzM0DpO6zMzZs=:cdra</li>
<li>登录 addauth digest imooc:imooc</li>
<li>获取数据 get /names/test</li>
</ul>

<h4>ip</h4>

<ul>
<li>setAcl /names/ip ip:192.168.31.224:cdrwa</li>
<li>getAcl -s /names/ip</li>
</ul>

<h4>acl常用场景</h4>

<ul>
<li>开发和测试环境分离</li>
<li>生产环境可以控制指定ip的服务可以访问相关节点，防止混乱</li>
</ul>

<h4>zk四字命令</h4>

<ul>
<li>echo stat | nc master 2181</li>
<li>echo ruok | nc master 2181</li>
<li>echo dump | nc master 2181 临时节点</li>
<li>cons 连接信息</li>
<li>mntr 健康信息</li>
<li>wchs watch信息</li>
<li>wchc与wchp session 与 watch 及 path 与 watch 信息</li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/16 21:34 下午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='Zookeeper.html'>Zookeeper</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15659499432841.html">
                
                  <h1>inline const mutable this staic</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>注意</h4>

<ul>
<li>成员函数可以访问成员变量，不管成员是否私有</li>
</ul>

<h4>inline</h4>

<ul>
<li>类中直接实现的成员函数，会被当成inline来处理，是否会处理成功取决于编译器自身</li>
</ul>

<h4>const</h4>

<ul>
<li>成员函数后面增加const,声明和定义都需要加const</li>
<li>不会修改对象里任何成员变量的值</li>
<li>常量成员函数</li>
<li>const只能给成员函数使用</li>
</ul>

<h4>mutable</h4>

<ul>
<li>不稳定，易改变</li>
<li>为了突破const的限制</li>
<li>mutable表示成员变量永远处于被修改状态</li>
</ul>

<h4>返回自身对象的引用</h4>

<ul>
<li>this Time const* this</li>
</ul>

<h4>静态变量</h4>

<ul>
<li>局部静态变量</li>
<li>static保证只能在本文件中使用</li>
<li>静态成员变量属于类本身</li>
<li>静态成员变量，一般在一个.cpp源文件开头来定义这个成员变量</li>
</ul>

<h4>析构函数</h4>

<ul>
<li>函数体是销毁new出来的东西</li>
<li>函数体之后系统接管和销毁</li>
</ul>

<h4>函数屏蔽</h4>

<ul>
<li>子类中有父类的同名函数，父类同名函数会被屏蔽</li>
<li>访问父类同名函数 using 让父类函数以重载方式执行，所有同名函数都可以见了</li>
</ul>

<h4>析构函数写成虚函数</h4>

<ul>
<li> 父类子针new子类的对象，delete的时候不会调用派生类的析构函数</li>
<li> 父类的析构函数写成虚函数，delete base会根据动态类型来执行析构函数</li>
<li> 父类对非继承的成员进行操作，需要把基类的函数定义为虚函数，析构函数的定义的虚属性会被继承给子类，这样子类中的析构函数也自然成为虚函数，虽然名字和基类的不同</li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/16 18:05 下午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='C++%E5%9F%BA%E7%A1%80%E4%B8%8E%E6%8F%90%E9%AB%98.html'>C++基础与提高</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15659210764719.html">
                
                  <h1>链表</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>反转</h4>

<ul>
<li>leet_206</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Reverse a singly linked list.

Example:

Input: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL
Output: 5-&gt;4-&gt;3-&gt;2-&gt;1-&gt;NULL
class Solution {
public:
    ListNode* reverseList(ListNode* head) {
      ListNode* pre = nullptr;
      while (head) {
        ListNode* next = head-&gt;next;
        head-&gt;next= pre;
        pre = head;
        head = next;
      }
      return pre;
    }
};
</code></pre>

<ul>
<li>leet_92</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Reverse a linked list from position m to n. Do it in one-pass.

Note: 1 ≤ m ≤ n ≤ length of list.

Example:

Input: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL, m = 2, n = 4
Output: 1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;NULL
class Solution {
public:
  ListNode* reverseBetween(ListNode* head, int m, int n) {
    ListNode dumy(0);
    dumy.next = head;
    ListNode* pre = &amp;dumy;
    for (int i = 0; i &lt; m - 1; i++) pre = pre-&gt;next;

    ListNode* cur = pre-&gt;next;
    for (int i = m; i &lt; n; i++) {
      ListNode* p = cur-&gt;next;
      cur-&gt;next = p-&gt;next;
      p-&gt;next = pre-&gt;next;
      pre-&gt;next = p;
    }
    
    return dumy.next;
  }
};
</code></pre>

<ul>
<li>leet_83</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Given a sorted linked list, delete all duplicates such that each element appear only  once.

Example 1:

Input: 1-&gt;1-&gt;2
Output: 1-&gt;2
class Solution {
public:
    ListNode* deleteDuplicates(ListNode* head) {
        ListNode *cur = head;
        while (cur &amp;&amp; cur-&gt;next) {
            if (cur-&gt;val == cur-&gt;next-&gt;val) {
                cur-&gt;next = cur-&gt;next-&gt;next;
            } else {
                cur = cur-&gt;next;
            }
        }
        return head;
    }
};
</code></pre>

<ul>
<li>leet_86 </li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Given a linked list and a value  x , partition it such that all nodes less than  x  come before nodes greater than or equal to  x.

You should preserve the original relative order of the nodes in each of the two partitions.

For example,
Given 1-&gt;4-&gt;3-&gt;2-&gt;5-&gt;2 and  x  = 3,
return 1-&gt;2-&gt;2-&gt;4-&gt;3-&gt;5.
就是将所有小于给定值的节点取出组成一个新的链表，此时原链表中剩余的节点的值都大于或等于给定值，只要将原链表直接接在新链表后即可
class Solution {
public:
    ListNode* partition(ListNode* head, int x) {
      ListNode node1(0);
      ListNode node2(0);
      ListNode* p1 = &amp;node1;
      ListNode* p2 = &amp;node2;
      while (head) {
        if (head-&gt;val &lt; x) {
          p1-&gt;next = head;
          p1 = p1-&gt;next;
        } else {
          p2-&gt;next = head;
          p2 = p2-&gt;next;
        }
        head = head-&gt;next;
      }
      p2-&gt;next = nullptr;
      p1-&gt;next = node2.next;
      return node1.next;
    }
};
</code></pre>

<ul>
<li>leet_328</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Given a singly linked list, group all odd nodes together followed by the even nodes. Please note here we are talking about the node number and not the value in the nodes.

You should try to do it in place. The program should run in O(1) space complexity and O(nodes) time complexity.

Example 1:

Input: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL
Output: 1-&gt;3-&gt;5-&gt;2-&gt;4-&gt;NULL
class Solution {
public:
    ListNode* oddEvenList(ListNode* head) {
      ListNode node1(0), node2(0);
      ListNode* p1 = &amp;node1;
      ListNode* p2 = &amp;node2;
      int cnt = 1;
      while (head) {
        if (cnt++ % 2 == 1) {
          p1-&gt;next = head;
          p1 = p1-&gt;next;
        } else {
          p2-&gt;next = head;
          p2 = p2-&gt;next;
        }
        head = head-&gt;next;
      }
      p2-&gt;next = nullptr;
      p1-&gt;next = node2.next;
      return node1.next;
    }
};
</code></pre>

<ul>
<li>leet_2</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Input: (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)
Output: 7 -&gt; 0 -&gt; 8
Explanation: 342 + 465 = 807.
class Solution {
public:
  ListNode* addTwoNumbers(ListNode* l1, ListNode* l2) {
    ListNode node(0), *p = &amp;node;
    int extra = 0;
    while (l1 || l2 || extra) {
      if (l1) extra += l1-&gt;val, l1 = l1-&gt;next;
      if (l2) extra += l2-&gt;val, l2 = l2-&gt;next;
      p-&gt;next = new ListNode(extra % 10);
      extra /= 10;
      p = p-&gt;next;
    }
    return node.next;

  }
};
</code></pre>

<ul>
<li>leet_445</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Follow up:
What if you cannot modify the input lists? In other words, reversing the lists is not allowed.

Example:

Input: (7 -&gt; 2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)
Output: 7 -&gt; 8 -&gt; 0 -&gt; 7
class Solution {
public:
  ListNode* addTwoNumbers(ListNode* l1, ListNode* l2) {
    ListNode node(0), *p = &amp;node;
    std::vector&lt;int&gt; num1, num2;
    while (l1) {
      num1.push_back(l1-&gt;val);
      l1 = l1-&gt;next;
    }
    while (l2) {
      num2.push_back(l2-&gt;val);
      l2 = l2-&gt;next;
    }

    int extra = 0;
    int i = num1.size();
    int j = num2.size();
    ListNode* pre = nullptr;
    while (i &gt; 0|| j &gt; 0|| extra) {
      if (--i &gt;= 0) extra += num1[i];
      if (--j &gt;= 0) extra += num2[j];
      ListNode* node = new ListNode(extra % 10);
      node-&gt;next = pre;
      pre = node;
      p-&gt;next = pre;
      extra /= 10;
    }
    return node.next;
  }
};
</code></pre>

<h4>设立虚拟头节点</h4>

<ul>
<li>leet_203</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Remove all elements from a linked list of integers that have value val.

Example
Given: 1 -- &gt; 2 --&gt; 6 --&gt; 3 --&gt; 4 --&gt; 5 --&gt; 6, val = 6
Return: 1 -- &gt; 2 --&gt; 3 --&gt; 4 --&gt; 5
class Solution {
public:
  ListNode* addTwoNumbers(ListNode* l1, ListNode* l2) {
    ListNode node(0), *p = &amp;node;
    int extra = 0;
    while (l1 || l2 || extra) {
      if (l1) extra += l1-&gt;val, l1 = l1-&gt;next;
      if (l2) extra += l2-&gt;val, l2 = l2-&gt;next;
      p-&gt;next = new ListNode(extra % 10);
      extra /= 10;
      p = p-&gt;next;
    }
    return node.next;

  }
};
</code></pre>

<ul>
<li>leet_82</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">class Solution {
public:
    ListNode* deleteDuplicates(ListNode* head) {
        if (!head || !head-&gt;next) return head;
        ListNode *dummy = new ListNode(-1), *pre = dummy;
        dummy-&gt;next = head;
        while (pre-&gt;next) {
            ListNode *cur = pre-&gt;next;
            while (cur-&gt;next &amp;&amp; cur-&gt;next-&gt;val == cur-&gt;val) {
                cur = cur-&gt;next;
            }
            if (cur != pre-&gt;next) pre-&gt;next = cur-&gt;next;
            else pre = pre-&gt;next;
        }
        return dummy-&gt;next;
    }
};
</code></pre>

<ul>
<li>leet_21</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Input: 1-&gt;2-&gt;4, 1-&gt;3-&gt;4
Output: 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4
class Solution {
public:
  ListNode* mergeTwoLists(ListNode* l1, ListNode* l2) {

    ListNode node(0), *p = &amp;node;
    while (l1 &amp;&amp; l2) {
      if (l1-&gt;val &lt; l2-&gt;val) {
        p-&gt;next = l1;
        l1 = l1-&gt;next;
      } else {
        p-&gt;next = l2;
        l2 = l2-&gt;next;
      }
      p = p-&gt;next;
    }

    p-&gt;next = l1 ? l1 : l2;
    return node.next;
  }
};
</code></pre>

<ul>
<li>leet_25</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Example:

Given this linked list: 1-&gt;2-&gt;3-&gt;4-&gt;5

For k = 2, you should return: 2-&gt;1-&gt;4-&gt;3-&gt;5

For k = 3, you should return: 3-&gt;2-&gt;1-&gt;4-&gt;5
class Solution {
public:
    ListNode* reverseKGroup(ListNode* head, int k) {
      ListNode dumy(0), *pre = &amp;dumy, *cur = &amp;dumy;
      dumy.next = head;
      int num = 0;
      while (cur = cur-&gt;next)  num++;
      while (num &gt;= k) {
        cur = pre-&gt;next;
        for (int i = 1; i &lt; k; i++) {
          ListNode* t = cur-&gt;next;
          cur-&gt;next = t-&gt;next;
          t-&gt;next = pre-&gt;next;
          pre-&gt;next = t;
        }
        pre = cur;
        num -= k;
      }
      return dumy.next;
    }
};
</code></pre>

<ul>
<li>leet_147</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Sort a linked list using insertion sort.
Input: 4-&gt;2-&gt;1-&gt;3
Output: 1-&gt;2-&gt;3-&gt;4
class Solution {
public:
    ListNode* insertionSortList(ListNode* head) {
        ListNode* dummy = new ListNode(0);
        dummy -&gt; next = head;
        ListNode *pre = dummy, *cur = head;
        while (cur) {
            if ((cur -&gt; next) &amp;&amp; (cur -&gt; next -&gt; val &lt; cur -&gt; val)) {
                while ((pre -&gt; next) &amp;&amp; (pre -&gt; next -&gt; val &lt; cur -&gt; next -&gt; val)) {
                    pre = pre -&gt; next;
                }
                ListNode* temp = pre -&gt; next;
                pre -&gt; next = cur -&gt; next;
                cur -&gt; next = cur -&gt; next -&gt; next;
                pre -&gt; next -&gt; next = temp;
                pre = dummy;
            }
            else {
                cur = cur -&gt; next;
            }
        }
        return dummy -&gt; next;
    }
};
</code></pre>

<ul>
<li>leet_148</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Sort a linked list in  O ( n  log  n ) time using constant space complexity.

Example 1:

Input: 4-&gt;2-&gt;1-&gt;3
Output: 1-&gt;2-&gt;3-&gt;4
Example 2:

Input: -1-&gt;5-&gt;3-&gt;4-&gt;0
Output: -1-&gt;0-&gt;3-&gt;4-&gt;5
class Solution {
public:
    ListNode* sortList(ListNode* head) {
        if (!head || !head-&gt;next) return head;
        ListNode *slow = head, *fast = head, *pre = head;
        while (fast &amp;&amp; fast-&gt;next) {
            pre = slow;
            slow = slow-&gt;next;
            fast = fast-&gt;next-&gt;next;
        }
        pre-&gt;next = NULL;
        return merge(sortList(head), sortList(slow));
    }
    ListNode* merge(ListNode* l1, ListNode* l2) {
        ListNode *dummy = new ListNode(-1);
        ListNode *cur = dummy;
        while (l1 &amp;&amp; l2) {
            if (l1-&gt;val &lt; l2-&gt;val) {
                cur-&gt;next = l1;
                l1 = l1-&gt;next;
            } else {
                cur-&gt;next = l2;
                l2 = l2-&gt;next;
            }
            cur = cur-&gt;next;
        }
        if (l1) cur-&gt;next = l1;
        if (l2) cur-&gt;next = l2;
        return dummy-&gt;next;
    }
};
</code></pre>

<ul>
<li>leet_237</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Supposed the linked list is 1 -&gt; 2 -&gt; 3 -&gt; 4 and you are given the third node with value 3, the linked list should become 1 -&gt; 2 -&gt; 4 after calling your function.
class Solution {
public:
    void deleteNode(ListNode* node) {
        node-&gt;val = node-&gt;next-&gt;val;
        ListNode *tmp = node-&gt;next;
        node-&gt;next = tmp-&gt;next;
        delete tmp;
    }
};
</code></pre>

<h4>双节点</h4>

<ul>
<li>leet_61</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Given a list, rotate the list to the right by  k  places, where  k  is non-negative.

For example:
Given 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL and  k  = 2,
return 4-&gt;5-&gt;1-&gt;2-&gt;3-&gt;NULL.
class Solution {
public:
    ListNode *rotateRight(ListNode *head, int k) {
        if (!head) return NULL;
        int n = 0;
        ListNode *cur = head;
        while (cur) {
            ++n;
            cur = cur-&gt;next;
        }
        k %= n;
        ListNode *fast = head, *slow = head;
        for (int i = 0; i &lt; k; ++i) {
            if (fast) fast = fast-&gt;next;
        }
        if (!fast) return head;
        while (fast-&gt;next) {
            fast = fast-&gt;next;
            slow = slow-&gt;next;
        }
        fast-&gt;next = head;
        fast = slow-&gt;next;
        slow-&gt;next = NULL;
        return fast;
    }
};
</code></pre>

<ul>
<li>leet_143</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Given a singly linked list  L :  L 0→ L 1→…→ L n -1→ L n,
reorder it to:  L 0→ L n → L 1→ L n -1→ L 2→ L n -2→…

You may not modify the values in the list&#39;s nodes, only nodes itself may be changed.

Example 1:

Given 1-&gt;2-&gt;3-&gt;4, reorder it to 1-&gt;4-&gt;2-&gt;3.
Example 2:

Given 1-&gt;2-&gt;3-&gt;4-&gt;5, reorder it to 1-&gt;5-&gt;2-&gt;4-&gt;3.
class Solution {
public:
  
    ListNode* reverse(ListNode* head) {
      ListNode *pre = nullptr, *next = nullptr;
      while (head) {
        next = head-&gt;next;
        head-&gt;next = pre;
        pre = head;
        head = next;
      }
      return pre;
    }
  
    void reorderList(ListNode* head) {
      if (!head || !head-&gt;next || !head-&gt;next-&gt;next) return;
      ListNode *slow = head, *fast = head;
      while (fast-&gt;next &amp;&amp; fast-&gt;next-&gt;next) {
        slow = slow-&gt;next;
        fast = fast-&gt;next-&gt;next;
      }
      
      ListNode* mid = slow-&gt;next;
      slow-&gt;next = nullptr;
      ListNode* rhead = reverse(mid);
      
      while (head &amp;&amp; rhead) {
        ListNode* next = head-&gt;next;
        head-&gt;next = rhead;
        rhead = rhead-&gt;next;
        head-&gt;next-&gt;next = next;
        head = next;
      }
    }
};
</code></pre>

<ul>
<li>leet_234</li>
</ul>

<pre class="line-numbers"><code class="language-cpp">Given a singly linked list, determine if it is a palindrome.

Example 1:

Input: 1-&gt;2
Output: false
Example 2:

Input: 1-&gt;2-&gt;2-&gt;1
Output: true
class Solution {
  public:
  ListNode* reverse(ListNode* head) {
    ListNode* pre = nullptr, *next = nullptr;

    while (head) {
      next = head-&gt;next;
      head-&gt;next = pre;
      pre = head;
      head = next;
    }

    return pre;
  }

  bool isPalindrome(ListNode* head) {
    if (!head || !head-&gt;next) return true;
    
    ListNode* fast = head, *slow = head;
    while (fast-&gt;next &amp;&amp; fast-&gt;next-&gt;next) {
      slow = slow-&gt;next;
      fast = fast-&gt;next-&gt;next;
    }

    ListNode* mid = slow-&gt;next;
    ListNode* rhead = reverse(mid);
    while (rhead) {
      if (rhead-&gt;val != head-&gt;val) return false;
      rhead = rhead-&gt;next;
      head = head-&gt;next;
    }
    return true;
  }
};
</code></pre>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/16 10:04 上午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='%E7%8E%A9%E8%BD%AC%E7%AE%97%E6%B3%95.html'>玩转算法</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15659185120492.html">
                
                  <h1>垃圾短信过滤</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	
                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/16 09:21 上午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95.html'>数据结构和算法</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
			<div class="article">
                <a class="clearlink" href="15658570800232.html">
                
                  <h1>数据语义学</h1>
                  <div class="a-content">
                      
                      <div class="a-content-text">
                        
                        	<h4>变量绑定</h4>

<ul>
<li>编译器对成员函数的解析，是在类定义完毕以后开始，对类成员变量的解析和绑定，是在类定义完成之后发生的，只有类定义完毕后，编译器才能看到类A中的成员变量</li>
<li>::引用全局的myvar的变量</li>
</ul>

<h4>成员函数</h4>

<ul>
<li>成员函数参数类型在编译器第一个遇到类型的时候绑定的</li>
<li>为了尽早的看到类型type，类型定义typedef一定要挪到类中的最早定义</li>
</ul>

<h4>进程内存空间布局</h4>

<ul>
<li>nm查看</li>
<li>类的静态成员变量也存在数据段</li>
</ul>

<h4>字节对齐</h4>

<pre class="line-numbers"><code class="language-text">#pragma pack(1) 不对齐
#pragma pack() 取消不对齐，继续对齐
</code></pre>

<h4>成员变量偏移值</h4>

<ul>
<li>&amp;class::m_val</li>
</ul>

<h4>静态成员变量存取</h4>

<ul>
<li>静态成员变量地址始终不变，写入了可执行文件</li>
</ul>

<h4>非静态成员变量</h4>

<ul>
<li>类对象的首地址加上成员变量的偏移值</li>
</ul>

<h4>数据成员布局</h4>

<ul>
<li>成员边界填充</li>
<li>引入继承关系，会带来额外的内存空间的开销</li>
<li>对象中会产生虚函数表指针vptr</li>
<li>增加或者扩展构造函数，增加给虚函数表指针的vptr赋值的代码</li>
<li>多重继续，子类继续2个父类，如果子类还有自己的虚函数的话和第一个基类共用vptr</li>
</ul>

<pre class="line-numbers"><code class="language-text">class Base {
 public:
  int m_bi;
  char m_b;
  char m_c;
  char m_d;
};
sizeof(Base)=8字节，填充一个字节

class Base {
 public:
  int m_bi;
  char m_b;
};

class Base2 : public Base {
 public:
  char m_c;
};

class Base3 : public Base2 {
 public:
  char m_d;
};
</code></pre>

<ul>
<li><img src="media/15658570800232/15659459670117.jpg" alt="" style="width:1206px;"/></li>
<li>内存拷贝要谨慎Base2拷贝到Base3，会产生内存拷贝</li>
</ul>

<h5>单一继承父类不带虚函数的成员布局</h5>

<ul>
<li><img src="media/15658570800232/15659491477127.jpg" alt="" style="width:337px;"/>、</li>
</ul>

<pre class="line-numbers"><code class="language-text">(gdb) p  obj
$1 = (Base3) {
  &lt;Base&gt; = {
    m_bi = 1
  },
  members of Base3:
  _vptr.Base3 = 0x400a80 &lt;vtable for Base3+16&gt;,
  m_i = 2,
  m_j = 3
}
(gdb) x/12x  &amp;obj
0x7fffffffdee0: 0x00400a80      0x00000000      0x00000001      0x00000002
0x7fffffffdef0: 0x00000003      0x00000000      0x00400740      0x00000000
0x7fffffffdf00: 0xffffdff0      0x00007fff      0x00000000      0x00000000
</code></pre>

<ul>
<li>依靠偏移值不能绘制真正的数据布局</li>
<li>vptr一直置顶</li>
</ul>

<h4>多重继承</h4>

<ul>
<li><img src="media/15658570800232/15660333053268.jpg" alt="" style="width:473px;"/></li>
<li>访问Base1不用跳，访问Base2变量this指针要偏移</li>
<li>先继承就顶格</li>
<li>this指针的调整都是编译器自动调整和偏移</li>
</ul>

<pre class="line-numbers"><code class="language-text">(gdb) x/20d bs2
0x7fffffffdee0: 4197896 0       12      3
0x7fffffffdef0: 6       0       -8480   32767
0x7fffffffdf00: -8208   32767   0       0
0x7fffffffdf10: 0       0       -148827179      32767
0x7fffffffdf20: 0       32      -8200   32767
(gdb) x/20d &amp;obj
0x7fffffffded0: 4197864 0       9       0
0x7fffffffdee0: 4197896 0       12      3
0x7fffffffdef0: 6       0       -8480   32767
0x7fffffffdf00: -8208   32767   0       0
0x7fffffffdf10: 0       0       -148827179      32767
Derived obj;
Base2* bs2 = &amp;obj;
Base2* bs2 = (Base2*)(((char*)&amp;obj) + sizeof(Base1))
Base1* bs1 = &amp;obj;
bs1和bs2的地址并不相同
bs2指向的是bs2子对象的指针
</code></pre>

<h4>虚基类中</h4>

<ul>
<li>传统多重继承，空间问题，效率问题，二义性</li>
<li>让grand只被继承一次，在孙子类中只有一份</li>
</ul>

<h4>虚基类</h4>

<ul>
<li>虚基类表</li>
<li>虚基类表指针</li>
<li>虚继承后，A1,A2会被插入一个虚基类表指针，C1会继承两个表指针</li>
<li><img src="media/15658570800232/15661179666970.jpg" alt="" style="width:725px;"/></li>
<li><img src="media/15658570800232/15661193718967.jpg" alt="" style="width:427px;"/></li>
<li>虚基类表记录偏移来找到虚基类子对象</li>
<li>虚基类表指针成员变量的首地址 + 偏移量 = 虚基类对象首地址</li>
</ul>

<h4>观察各种继承</h4>

<ul>
<li>虚基类表的偏移值</li>
<li>虚基类表中的偏移量按照继承顺序来存放</li>
<li>虚基类子对象一直放在最下面</li>
</ul>

<h4>虚基类1-4字节分析</h4>

<ul>
<li>虚基类表指针成员变量的首地址，和本对象A1首地址的偏移量，也就是虚基类表指针 - A1的对象的首地址</li>
<li>只有对虚基类成员进行赋值的时候，才会用到虚基类</li>
</ul>

<h4>三层结构虚基类表内容分析</h4>

<ul>
<li><img src="media/15658570800232/15662039845414.jpg" alt="" style="width:743px;"/></li>
<li>虚基类在编译的时候已经固定了</li>
<li>vptr2基本没用到只用到vptr1</li>
<li>访问虚基类的成员变量要比普通成员变量慢</li>
</ul>

<h4>成员变量地址，偏移和指针</h4>

<h4>成员变量偏移值和偏移指针</h4>

<ul>
<li>和具体对象没有关系</li>
<li>成员变量指针保存的是一个偏移值，不是实际内存地址</li>
<li>没有指向任何数据成员的指针</li>
</ul>

<pre class="line-numbers"><code class="language-text">int main() {
  Obj obj;
  obj.m_i = obj.m_j = obj.m_k = 0;
  printf(&quot;mi = %p \n&quot;, &amp;obj.m_i);

  Obj* p = &amp;obj;
  printf(&quot;mi = %p \n&quot;, p-&gt;m_i);
  printf(&quot;mj = %p \n&quot;, p-&gt;m_j);

  int* p1 = &amp;obj.m_i;
  int* p2 = &amp;obj.m_j;

  *p1 = 15;
  *p2 = 30;
  printf(&quot;p1 = %p  p1 val %d \n&quot;, p1, *p1);
  printf(&quot;p2 = %p  p2 val %d \n&quot;, p2, *p2);

  printf(&quot;m_i offset %d \n&quot;, &amp;Obj::m_i);
  printf(&quot;m_j offset %d \n&quot;, &amp;Obj::m_j);
  printf(&quot;m_k offset %d \n&quot;, &amp;Obj::m_k);


  int Obj::*ptr = &amp;Obj::m_i;
  printf(&quot;m_k offset %d \n&quot;, ptr);
  obj.*ptr = 13;
  p-&gt;*ptr = 20;
  ptr = nullptr; 编译器会把ptr设置为-1
  ptr += 1//不允许
}
</code></pre>

<ul>
<li></li>
</ul>

                        
                      </div>
                  </div>
                </a>
                <div class="read-more clearfix">
                  <div class="more-left left">
                  
                    <span class="date">2019/08/15 16:18 下午</span>
                    <span>posted in&nbsp;</span> 
          				  
          					    <span class="posted-in"><a href='C++%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B.html'>C++对象模型</a></span>
          				   
                  </div>
                  <div class="more-right right">
                  <span class="comments">
                      

                       
                  </span>
                  </div>
                </div>
              </div><!-- article -->
        
              


			<div class="row">
			  <div class="large-6 columns">
			  <p class="text-left" style="padding-top:25px;">
			   <a href="all_26.html">&laquo; Prev Page</a>  
			  </p>
			  </div>
			  <div class="large-6 columns">
			<p class="text-right" style="padding-top:25px;">
			 <a href="all_28.html">&raquo; Next Page</a> 
			</p>
			  </div>
			</div>
		</div>
	</div><!-- large 8 -->

 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
          <div id="site-info" class="site-info">
            
                <h1>eredin-blog</h1>
                <div class="site-des">生命的意义是成为你自己！</div>
                <div class="social">











  <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
                
              	 </div>
          	</div>

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>Categories</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="Prometheus.html"><strong>Prometheus</strong></a>
        
            <a href="RocketMQ.html"><strong>RocketMQ</strong></a>
        
            <a href="%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE.html"><strong>网络协议</strong></a>
        
            <a href="Golang.html"><strong>Golang</strong></a>
        
            <a href="Django.html"><strong>Django</strong></a>
        
            <a href="C++%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%AE%9E%E6%88%98.html"><strong>C++设计模式实战</strong></a>
        
            <a href="%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90Kubernetes.html"><strong>深入剖析Kubernetes</strong></a>
        
            <a href="%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95.html"><strong>数据结构和算法</strong></a>
        
            <a href="%E5%BE%AE%E6%9C%8D%E5%8A%A1.html"><strong>微服务</strong></a>
        
            <a href="%E6%9E%B6%E6%9E%84.html"><strong>架构</strong></a>
        
            <a href="%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86.html"><strong>操作系统原理</strong></a>
        
            <a href="Mysql%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98.html"><strong>Mysql优化实战</strong></a>
        
            <a href="Kafka.html"><strong>Kafka</strong></a>
        
            <a href="linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A0%94%E5%8F%91.html"><strong>linux服务器研发</strong></a>
        
            <a href="%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.html"><strong>计算机组成原理</strong></a>
        
            <a href="%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB.html"><strong>程序员的自我修养</strong></a>
        
            <a href="C%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6.html"><strong>C语言进阶</strong></a>
        
            <a href="http_study.html"><strong>http_study</strong></a>
        
            <a href="%E7%8E%A9%E8%BD%AC%E7%AE%97%E6%B3%95.html"><strong>玩转算法</strong></a>
        
            <a href="C++%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B.html"><strong>C++对象模型</strong></a>
        
            <a href="SQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A.html"><strong>SQL必知必会</strong></a>
        
            <a href="Zookeeper.html"><strong>Zookeeper</strong></a>
        
            <a href="Redis%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A.html"><strong>Redis从入门到精通</strong></a>
        
            <a href="%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95%E8%BF%9B%E9%98%B6.html"><strong>数据结构和算法进阶</strong></a>
        
            <a href="Mysql%E6%80%A7%E8%83%BD%E7%AE%A1%E7%90%86%E5%92%8C%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html"><strong>Mysql性能管理和架构设计</strong></a>
        
            <a href="%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98.html"><strong>网络编程实战</strong></a>
        
            <a href="Redis%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BC%93%E5%AD%98.html"><strong>Redis高并发缓存</strong></a>
        
            <a href="C++%E5%9F%BA%E7%A1%80%E4%B8%8E%E6%8F%90%E9%AB%98.html"><strong>C++基础与提高</strong></a>
        
            <a href="%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%BE%8E.html"><strong>设计模式之美</strong></a>
        
            <a href="Python.html"><strong>Python</strong></a>
        
            <a href="%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html"><strong>设计模式</strong></a>
        
            <a href="Linux%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98.html"><strong>Linux性能优化实战</strong></a>
        
            <a href="%E5%80%99%E6%8D%B7STL.html"><strong>候捷STL</strong></a>
        
            <a href="%E6%80%A7%E8%83%BD%E5%B7%A5%E7%A8%8B%E9%AB%98%E6%89%8B%E8%AF%BE.html"><strong>性能工程高手课</strong></a>
        
            <a href="%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.html"><strong>性能测试</strong></a>
        
            <a href="ElasticSearch.html"><strong>ElasticSearch</strong></a>
        
            <a href="RabbitMQ.html"><strong>RabbitMQ</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>Recent Posts</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="15817610843879.html">编译期</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15814649492497.html">Simple Factory</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15814189410719.html">代码的可测试性</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15814188057978.html">重构</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15813811739408.html">tuple 使用</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>

    
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>


  </body>
</html>
